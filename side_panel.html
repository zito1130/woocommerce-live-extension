<!DOCTYPE html>
<html>
<head>
    <title>WooCommerce 直播助手</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="toast-container"></div>
    <nav class="tab-buttons">
        <button class="tab-button active" data-tab="live">直播管理</button>
        <button class="tab-button" data-tab="settings">商店設定</button>
        <button class="tab-button" data-tab="products">商品設置</button>
    </nav>

    <main class="tab-content">
        <div class="tab-pane active" id="live">
            <div class="live-layout-container">
                <div class="live-controls-column">
                    <div class="current-setting">
                        <span>監控主播：</span>
                        <strong id="currentTiktokUserDisplay">尚未設定</strong>
                    </div>
                    <hr>
                    <h3>直播標題</h3>
                    <div class="live-title-area">
                        <input type="text" id="liveTitle" placeholder="正在生成標題...">
                        <button class="submit-button" id="startLiveButton">開始直播</button>
                    </div>
                    <div id="liveControls" class="live-controls-area hidden">
                        <button class="control-button pause" id="pauseResumeButton">暫停直播</button>
                        <button class="control-button end" id="endLiveButton">結束直播</button>
                    </div>
                    <hr>
                    <div class="products-on-market">
                        <h3>商品上架</h3>
                        <div class="products-info-area">
                            <input type="text" id="productName" placeholder="商品名稱...">
                            <div class="qty-price">
                                <input type="text" id="productQty" placeholder="數量...">
                                <input type="text" id="productPrice" placeholder="價格...">
                            </div>
                            <input type="text" id="productCall" placeholder="Call號...">
                            <select id="shippingClassSelector">
                                <option value="">-- 運送類別 --</option>
                            </select>
                        </div>
                        <button class="submit-button" id="onMarketButton">上架</button>
                    </div>
                    <hr>
                    <div class="product-list-area">
                        <div class="list-header">
                            <h3>商品列表</h3>
                            <div class="batch-actions">
                                <button id="unpublishAllBtn" class="batch-button">全數下架</button>
                                <button id="publishAllBtn" class="batch-button">全數上架</button>
                                <button id="clearCallNumbersBtn" class="batch-button">清空叫號</button>
                            </div>
                        </div>
                        <div id="productsList">
                            </div>
                    </div>
                </div>
                <div class="live-comments-column">
                    <h3>即時留言</h3>
                    <div id="comment-list"></div>
                    <hr>
                    <h3>喊單紀錄</h3>
                    <div id="order-log-list"></div>
                </div>
            </div>
        </div>
        
        <div class="tab-pane" id="settings">
            <h3>商店設定</h3>
            <div><label for="storeUrl">商店網址</label><input type="text" id="storeUrl" placeholder="https://mystore.com"></div>
            <div><label for="consumerKey">金鑰</label><input type="text" id="consumerKey" placeholder="ck_..."></div>
            <div><label for="consumerSecret">密鑰</label><input type="password" id="consumerSecret" placeholder="cs_..."></div>
            <hr>
            <h3>直播設定</h3>
            <div><label for="eulerstreamKey">Eulerstream API Key</label><input type="password" id="eulerstreamKey" placeholder="請貼上您的 Eulerstream 金鑰"></div>
            <div><label for="tiktokUsername">TikTok 主播帳號 (@username)</label><input type="text" id="tiktokUsername" placeholder="@nasa"></div>
            <div class="submit-area"><button class="submit-button" id="saveButton">儲存所有設定</button><button class="submit-button" id="testButton">測試商店連線</button></div>
            <hr>
            <div id="status"></div>
        </div>
        <div class="tab-pane" id="products">
            <h3>預設分類設定</h3>
            <p>請先在「商店設定」分頁中測試連線，成功後這裡會自動載入您的商品分類。</p>
            <div><label for="categorySelector">選擇一個預設分類</label><select id="categorySelector" disabled><option value="">請先載入分類...</option></select></div>
            <div class="current-setting"><span>目前預設分類：</span><strong id="currentCategoryDisplay">尚未設定</strong></div>
            <div class="submit-area"><button class="submit-button" id="saveCategoryButton">儲存預設分類</button></div>
            <div id="categoryStatus"></div>
            <hr>
        </div>
    </main>

    <div id="editProductModal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3 id="modalProductName">編輯商品</h3>
            <div class="modal-form">
                <div><label>數量</label><input type="number" id="modalProductQty"></div>
                <div><label>價格</label><input type="text" id="modalProductPrice"></div>
                <div><label>Call號</label><input type="text" id="modalProductCall"></div>
            </div>
            <div class="modal-actions">
                <button id="modalCancelButton" class="control-button pause">取消</button>
                <button id="modalUpdateTimeButton" class="control-button pause" style="background-color: #ffc107;">更新時間</button>
                <button id="modalUpdateButton" class="control-button end">確認更新</button>
            </div>
            <div id="modalStatus" class="market-status-area"></div>
        </div>
    </div>

    <script src="side_panel.js"></script>
</body>
</html>